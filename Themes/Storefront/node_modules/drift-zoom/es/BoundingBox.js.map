{"version":3,"sources":["../src/js/BoundingBox.js"],"names":["throwIfMissing","addClasses","removeClasses","BoundingBox","options","isShowing","namespace","zoomFactor","containerEl","settings","openClasses","_buildClasses","_buildElement","suffix","classes","ns","push","el","document","createElement","zoomPaneWidth","zoomPaneHeight","appendChild","style","width","Math","round","height","removeChild","percentageOffsetX","percentageOffsetY","triggerRect","pageXOffset","window","pageYOffset","inlineLeft","left","clientWidth","inlineTop","top","clientHeight","elRect","getBoundingClientRect"],"mappings":"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","sourcesContent":["import throwIfMissing from \"./util/throwIfMissing\";\nimport { addClasses, removeClasses } from \"./util/dom\";\n\nexport default class BoundingBox {\n  constructor(options) {\n    this.isShowing = false;\n\n    let { namespace = null, zoomFactor = throwIfMissing(), containerEl = throwIfMissing() } = options;\n\n    this.settings = { namespace, zoomFactor, containerEl };\n\n    this.openClasses = this._buildClasses(\"open\");\n\n    this._buildElement();\n  }\n\n  _buildClasses(suffix) {\n    let classes = [`drift-${suffix}`];\n\n    let ns = this.settings.namespace;\n    if (ns) {\n      classes.push(`${ns}-${suffix}`);\n    }\n\n    return classes;\n  }\n\n  _buildElement() {\n    this.el = document.createElement(\"div\");\n    addClasses(this.el, this._buildClasses(\"bounding-box\"));\n  }\n\n  show(zoomPaneWidth, zoomPaneHeight) {\n    this.isShowing = true;\n\n    this.settings.containerEl.appendChild(this.el);\n\n    let style = this.el.style;\n    style.width = `${Math.round(zoomPaneWidth / this.settings.zoomFactor)}px`;\n    style.height = `${Math.round(zoomPaneHeight / this.settings.zoomFactor)}px`;\n\n    addClasses(this.el, this.openClasses);\n  }\n\n  hide() {\n    if (this.isShowing) {\n      this.settings.containerEl.removeChild(this.el);\n    }\n\n    this.isShowing = false;\n\n    removeClasses(this.el, this.openClasses);\n  }\n\n  setPosition(percentageOffsetX, percentageOffsetY, triggerRect) {\n    let pageXOffset = window.pageXOffset;\n    let pageYOffset = window.pageYOffset;\n\n    let inlineLeft = triggerRect.left + percentageOffsetX * triggerRect.width - this.el.clientWidth / 2 + pageXOffset;\n    let inlineTop = triggerRect.top + percentageOffsetY * triggerRect.height - this.el.clientHeight / 2 + pageYOffset;\n\n    let elRect = this.el.getBoundingClientRect();\n\n    if (inlineLeft < triggerRect.left + pageXOffset) {\n      inlineLeft = triggerRect.left + pageXOffset;\n    } else if (inlineLeft + this.el.clientWidth > triggerRect.left + triggerRect.width + pageXOffset) {\n      inlineLeft = triggerRect.left + triggerRect.width - this.el.clientWidth + pageXOffset;\n    }\n\n    if (inlineTop < triggerRect.top + pageYOffset) {\n      inlineTop = triggerRect.top + pageYOffset;\n    } else if (inlineTop + this.el.clientHeight > triggerRect.top + triggerRect.height + pageYOffset) {\n      inlineTop = triggerRect.top + triggerRect.height - this.el.clientHeight + pageYOffset;\n    }\n\n    this.el.style.left = `${inlineLeft}px`;\n    this.el.style.top = `${inlineTop}px`;\n  }\n}\n"],"file":"BoundingBox.js"}